# P2 評估報告：Hono → Grammy 遷移評估

**日期**: 2026-02-26  
**當前框架**: Hono (非 Telegraf)  
**評估目標**: 是否需要遷移至 Grammy

---

## 1. 現況分析

### 1.1 當前技術棧
- **Webhook 框架**: Hono（輕量級 Node.js 框架）
- **部署環境**: Cloud Run
- **Telegram API 呼叫**: 直接使用 fetch（无框架封装）

### 1.2 與報告假設的差異
- 原始報告假設使用 Telegraf → 建議遷移至 Grammy
- **實際情況**：已使用 Hono，沒有 Telegraf 的技術負債

---

## 2. Hono vs Grammy 對比

| 面向 | Hono (現用) | Grammy |
|------|-------------|--------|
| **設計目標** | 通用 Web 框架 | Telegram Bot 專用框架 |
| **TypeScript** | ✅ 原生 | ✅ 原生 |
| **Bot API 封裝** | ❌ 需自行實作 | ✅ 完整封裝 |
| **Middleware** | ✅ 簡潔強大 | ✅ Bot 專用 |
| **學習曲線** | ✅ 低 | 中等 |
| **生態** | 通用 | Telegram 專門 |

---

## 3. 遷移成本估算

| 項目 | 工作量 | 說明 |
|------|--------|------|
| Webhook 層重寫 | 1-2 天 | 把 `Hono` → `Grammy` bot |
| Handler 調整 | 1 天 | 把 `ctx.req.json()` → Grammy 格式 |
| Telegram API 封裝 | 0 天 | Grammy 內建 |
| 測試驗證 | 2-3 天 | 完整功能測試 |
| **總計** | **4-6 天** | |

---

## 4. 建議

### 4.1 維持現狀（Hono）的理由
1. **沒有技術負債**：Hono 輕量且運作正常
2. **已客製化**：P0/P1 強化已實作（錯誤處理、速率限制、佇列）
3. **遷移效益有限**：收益不明顯，風險中等
4. **資源有限**：建議優先做其他功能

### 4.2 遷移 Grammy 的理由（未來）
1. Bot 專用框架，開發效率更高
2. 更好的 TypeScript 類型支援
3. 內建速率限制、錯誤處理插件

---

## 5. 結論

**建議：維持 Hono，暫不遷移**

理由：
- 當前系統已穩定運作
- P0/P1 強化已完成基礎設施優化
- 遷移 Grammy 的效益不明顯
- 可在未來有明確需求時再評估

---

## 6. 未來監控指標

若未來考慮遷移，追蹤以下指標：
- Bot 請求延遲是否 > 500ms
- 開發新功能是否因框架受限
- 社群對 Grammy 的採用趨勢
